# Документация по аугментациям

## Основано на победном решении
Источник: https://www.kaggle.com/competitions/asl-signs/discussion/406684

## Структура данных
- **Landmarks**: 468 точек (0-467)
- **Координаты**: x, y, z для каждой точки
- **Препроцессинг**: position + velocity + acceleration = 4212 features

## Типы аугментаций

### 1. Временные аугментации (Temporal)

#### Temporal Resampling
- **Описание**: Изменение скорости воспроизведения жеста
- **Параметры**: factor ∈ [0.8, 1.2]
- **Реализация**: Linear interpolation с сохранением длины
- **Вероятность**: 50%
- **Размеры**: Сохраняет исходную длину последовательности

#### Temporal Masking
- **Описание**: Маскирование временных сегментов
- **Параметры**: max_mask_ratio = 0.15
- **Реализация**: Обнуление случайного сегмента
- **Вероятность**: 20%

### 2. Пространственные аугментации (Spatial)

#### Spatial Rotation
- **Описание**: Вращение в плоскости XY
- **Параметры**: max_angle = ±15°
- **Реализация**: Матрица вращения для каждой пары (x,y)
- **Вероятность**: 70%

#### Spatial Scale
- **Описание**: Масштабирование
- **Параметры**: scale ∈ [0.9, 1.1]
- **Реализация**: Умножение x,y координат на коэффициент
- **Вероятность**: 70%

#### Spatial Translation
- **Описание**: Смещение
- **Параметры**: shift ∈ [-0.1, 0.1]
- **Реализация**: Добавление смещения к x,y координатам
- **Вероятность**: 70%

#### Spatial Flip
- **Описание**: Горизонтальное отражение
- **Параметры**: Инверсия знака x координат
- **Реализация**: x = -x для всех точек
- **Вероятность**: 70%

### 3. Шум и маскирование

#### Spatial Noise
- **Описание**: Добавление гауссова шума
- **Параметры**: std = 0.01
- **Реализация**: x + N(0, 0.01)
- **Вероятность**: 30%

#### Feature Masking
- **Описание**: Маскирование признаков
- **Параметры**: max_mask_ratio = 0.1
- **Реализация**: Обнуление случайного сегмента features
- **Вероятность**: 20%

#### Landmark Dropout
- **Описание**: Dropout для отдельных точек
- **Параметры**: dropout_prob = 0.1
- **Реализация**: Bernoulli mask
- **Вероятность**: 20%

## Порядок применения

```python
# 1. Временные аугментации
x = temporal_resample(x)
x = temporal_masking(x)

# 2. Пространственные аугментации
x = spatial_rotation(x)
x = spatial_scale(x)
x = spatial_translation(x)
x = spatial_flip(x)

# 3. Шум и маскирование
x = spatial_noise(x)
x = feature_masking(x)
x = landmark_dropout(x)
```

## Использование

```python
from augmentations import ASLAugmentations

# Создание аугментатора
augmenter = ASLAugmentations(
    temporal_prob=0.5,
    spatial_prob=0.7,
    noise_prob=0.3,
    mask_prob=0.2
)

# Применение аугментаций
# x: (batch_size, frames, features)
x_augmented = augmenter(x)
```

## Настройки по умолчанию

```python
ASLAugmentations(
    temporal_prob=0.5,    # Временные аугментации
    spatial_prob=0.7,     # Пространственные аугментации
    noise_prob=0.3,       # Шум
    mask_prob=0.2         # Маскирование
)
```

## Важные особенности

1. **Совместимость с препроцессором**: Аугментации работают с данными после препроцессинга
2. **Порядок операций**: Landmarks → Препроцессинг → Features → Аугментации
3. **Сохранение размеров**: Все аугментации сохраняют исходные размеры данных (batch, frames, features)
4. **Случайность**: Каждая аугментация применяется с заданной вероятностью
5. **Безопасность**: Все операции защищены от выхода за границы
6. **Совместимость с DataLoader**: Аугментации не изменяют структуру батчей

## Тестирование

```python
python augmentations.py
```

Этот скрипт проверит:
- Корректность работы всех аугментаций
- Изменение размерностей данных
- Применение отдельных аугментаций 