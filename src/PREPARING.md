# ü§ü –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –¥–ª—è Google ASL Signs (–∫–∞–∫ —É –ø–æ–±–µ–¥–∏—Ç–µ–ª—è)

## üìä –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ `data_exploration.py`, —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ **—Ä–µ—à–µ–Ω–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è**, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Google ASL Signs dataset:

### –§–æ—Ä–º–∞—Ç landmark —Ñ–∞–π–ª–æ–≤ (parquet)
```
–ö–æ–ª–æ–Ω–∫–∏: ['frame', 'row_id', 'type', 'landmark_index', 'x', 'y', 'z']
- frame: –Ω–æ–º–µ—Ä –∫–∞–¥—Ä–∞
- row_id: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ç—Ä–æ–∫–∏
- type: —Ç–∏–ø landmarks ('face', 'pose', 'left_hand', 'right_hand')
- landmark_index: –∏–Ω–¥–µ–∫—Å —Ç–æ—á–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö —Ç–∏–ø–∞
- x, y, z: –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π**: ~100,000
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤**: 250
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤**: ~1000
- **–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–¥—Ä–æ–≤**: 50-100
- **–¢–∏–ø—ã landmarks**:
  - Face: 468 —Ç–æ—á–µ–∫ (MediaPipe Face Mesh)
  - Pose: 33 —Ç–æ—á–∫–∏ (MediaPipe Pose)
  - Left Hand: 21 —Ç–æ—á–∫–∞ (MediaPipe Hands)
  - Right Hand: 21 —Ç–æ—á–∫–∞ (MediaPipe Hands)
- **–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: ~3%

### üèÜ –†–µ—à–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
**1st place solution - 1DCNN combined with Transformer**
- **–ú–æ–¥–µ–ª—å**: 1D CNN + Transformer ensemble
- **–¢–æ—á–Ω–æ—Å—Ç—å**: CV 0.80, Public LB 0.80, Private LB 0.88
- **–ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏**: left-right hand, eye, nose, and lips landmarks
- **Motion features**: lag1 (dx) –∏ lag2 (dx2)
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**: –ø–æ nose landmark (—Ç–æ—á–∫–∞ 17)

## üîß –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∫–∞–∫ —É –ø–æ–±–µ–¥–∏—Ç–µ–ª—è)

1. **–¢–æ—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö landmark —Ç–æ—á–µ–∫ (–Ω–æ—Å, –≥–ª–∞–∑–∞, –≥—É–±—ã, —Ä—É–∫–∏)
   - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ nose landmark (—Ç–æ—á–∫–∞ 17)
   - Motion features: lag1 –∏ lag2 (—Ç–æ—á–Ω–æ –∫–∞–∫ —É –ø–æ–±–µ–¥–∏—Ç–µ–ª—è)

2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
   - –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ parquet —Ñ–∞–π–ª–æ–≤
   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ç–æ—á–µ–∫

3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è (–±–µ–∑ nanstd)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (NaN)
   - Motion features (dx –∏ dx2)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

```python
class ASLPreprocessor(nn.Module):
    def __init__(self, 
                 max_len: int = 384,
                 point_landmarks: Optional[List[int]] = None):
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_len`: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∫–∞–∫ —É –ø–æ–±–µ–¥–∏—Ç–µ–ª—è: 384)
- `point_landmarks`: —Å–ø–∏—Å–æ–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ —Ç–æ—á–µ–∫ (–∫–∞–∫ —É –ø–æ–±–µ–¥–∏—Ç–µ–ª—è: –Ω–æ—Å, –≥–ª–∞–∑–∞, –≥—É–±—ã, —Ä—É–∫–∏)

### –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
   ```python
   landmarks = preprocessor.load_landmark_file(file_path)
   # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: (frames, total_landmarks, 3)
   ```

2. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**
   - –ü–æ nose landmark (—Ç–æ—á–∫–∞ 17 –≤ face landmarks)
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

3. **Motion features**
   - –°–∫–æ—Ä–æ—Å—Ç—å: dx = x[t+1] - x[t]
   - –£—Å–∫–æ—Ä–µ–Ω–∏–µ: dx2 = x[t+2] - x[t]

4. **–§–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏**
   - Concatenate: position + velocity + acceleration
   - –ó–∞–º–µ–Ω–∞ NaN –Ω–∞ 0

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ preprocessing.py      # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
‚îú‚îÄ‚îÄ data_loader.py        # –ó–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ data_utils.py         # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ analyze_data_structure.py  # –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from preprocessing import ASLPreprocessor
from data_loader import ASLDataLoader

# –°–æ–∑–¥–∞–µ–º –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
preprocessor = ASLPreprocessor(
    max_len=384,
    use_face=True,
    use_pose=True,
    use_hands=True
)

# –°–æ–∑–¥–∞–µ–º –∑–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö
dataloader = ASLDataLoader(
    data_dir="../data/google_asl_signs",
    batch_size=32,
    max_len=384,
    preprocessor=preprocessor
)

# –ü–æ–ª—É—á–∞–µ–º DataLoader'—ã
train_loader, val_loader, test_loader = dataloader.get_dataloaders()
```

### –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
```python
from data_utils import ASLDataAnalyzer

# –°–æ–∑–¥–∞–µ–º –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
analyzer = ASLDataAnalyzer()

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
stats = analyzer.analyze_dataset_statistics()

# –°–æ–∑–¥–∞–µ–º —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–ª–∏—Ç—ã
train_df, val_df, test_df = analyzer.create_balanced_splits()
```

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ NaN –∑–Ω–∞—á–µ–Ω–∏–π
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### 2. Motion features
- –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è –∏–∑ –ø–æ–±–µ–¥–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- –£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–∏ –∂–µ—Å—Ç–æ–≤
- –£–ª—É—á—à–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–π

### 3. –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä—É–∫–∏ –¥–ª—è ASL
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ face landmarks –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 4. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –í–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ batch processing
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–¥–∞–ø—Ç–∞—Ü–∏–∏

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- ‚úÖ –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ motion features
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞: ~10-50ms
- –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –±–∞—Ç—á–∞ (32 –æ–±—Ä–∞–∑—Ü–∞): ~100-200ms
- –ü–∞–º—è—Ç—å –Ω–∞ –±–∞—Ç—á: ~50-100MB (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç max_len)

## üîÆ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞ –∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
   - –í—Ä–µ–º–µ–Ω–Ω–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è
   - –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏**
   - –°–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö
   - –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏**
   - –£–≥–ª—ã –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
   - –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É landmarks
   - –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã

4. **–ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
   - GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞
```bash
# 1. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
python data_exploration.py

# 2. –¢–µ—Å—Ç –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞  
python preprocessing.py

# 3. –¢–µ—Å—Ç –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π
python augmentations.py

# 4. –¢–µ—Å—Ç DataLoader
python dataset.py

# 5. –í—Å–µ –≤–º–µ—Å—Ç–µ
python -c "
from dataset import test_dataloader
from preprocessing import test_preprocessor  
from augmentations import test_augmentations

print('üöÄ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –ø–∞–π–ø–ª–∞–π–Ω–∞...')
test_preprocessor()
test_augmentations() 
test_dataloader()
print('‚úÖ –ì–æ—Ç–æ–≤—ã –∫ –æ–±—É—á–µ–Ω–∏—é!')
```